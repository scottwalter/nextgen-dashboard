import{u as _,y as S,r as g,a as E,o as r,e as a,f as t,g as b,p as T,w as s,q as l,s as h,B as D,t as m,v as A,m as B,i as v,F as q,h as R,b as j}from"./index-d0e904d7.js";import{_ as L}from"./_plugin-vue_export-helper-c27b6911.js";const M={class:"bootstrap-page"},W={class:"bootstrap-container"},J={class:"bootstrap-content"},N={class:"form-section"},P={class:"form-group"},$={class:"form-group"},I={class:"form-section"},F={class:"form-group"},H={class:"checkbox-label"},K={key:0,class:"auth-settings"},O={class:"form-group"},G={class:"form-group"},z={class:"password-input"},Q=["type"],X={class:"form-group"},Y={class:"jwt-input"},Z={class:"form-group"},ee={class:"form-section"},te={class:"device-header"},oe=["onClick"],ie={class:"form-group"},ne=["onUpdate:modelValue"],se={class:"form-group"},re=["onUpdate:modelValue"],ae={class:"form-section"},le={class:"form-group"},de={class:"checkbox-label"},ue={key:0,class:"mining-core-settings"},pe={class:"form-group"},ce={class:"form-actions"},me=["disabled"],ve={key:0,class:"error"},fe={__name:"BootstrapView",setup(ge){const y=_(),C=S(),u=g(!1),p=g(!1),d=g(""),o=E({applicationTitle:"Bitaxe Dashboard",url:window.location.origin,authentication:{enabled:!1,username:"",password:"",jwtSecret:"",jwtExpiration:"1d"},devices:[{name:"",url:""}],miningCore:{enabled:!1,url:""}}),U=()=>{o.devices.push({name:"",url:""})},k=n=>{o.devices.splice(n,1)},w=async()=>{try{const n=await j.login("","")}catch{const e=new Uint8Array(32);crypto.getRandomValues(e),o.authentication.jwtSecret=Array.from(e,i=>i.toString(16).padStart(2,"0")).join("")}},x=()=>{if(!o.applicationTitle.trim())throw new Error("Application title is required");if(o.devices.length===0)throw new Error("At least one device must be configured");for(let n=0;n<o.devices.length;n++){const e=o.devices[n];if(!e.name.trim())throw new Error(`Device ${n+1} name is required`);if(!e.url.trim())throw new Error(`Device ${n+1} URL is required`);try{new URL(e.url)}catch{throw new Error(`Device ${n+1} has an invalid URL`)}}if(o.authentication.enabled){if(!o.authentication.username.trim())throw new Error("Username is required when authentication is enabled");if(!o.authentication.password.trim())throw new Error("Password is required when authentication is enabled");if(!o.authentication.jwtSecret.trim())throw new Error("JWT secret must be generated when authentication is enabled")}if(o.miningCore.enabled&&!o.miningCore.url.trim())throw new Error("Mining core URL is required when mining core integration is enabled");if(o.miningCore.enabled&&o.miningCore.url.trim())try{new URL(o.miningCore.url)}catch{throw new Error("Mining core URL is invalid")}},V=async()=>{d.value="",p.value=!0;try{x(),o.devices.forEach((e,i)=>{e.id=e.name.toLowerCase().replace(/\s+/g,"-")||`device-${i+1}`});const n=await C.createConfig(o);n.success?y.push("/"):d.value=n.error||"Failed to create configuration"}catch(n){d.value=n.message}finally{p.value=!1}};return w(),(n,e)=>(r(),a("div",M,[t("div",W,[e[31]||(e[31]=t("div",{class:"bootstrap-header"},[t("h1",null,"Bitaxe Dashboard - First Time Setup"),t("p",{class:"version"},"Version 2.0")],-1)),t("div",J,[e[30]||(e[30]=t("div",{class:"welcome-section"},[t("h2",null,"Welcome to Bitaxe Dashboard"),t("p",null,"This system is for your first-time viewing the application. Please configure the initial settings below."),t("p",{class:"warning"},[t("strong",null,"Note:"),b(" Once you save the settings your application will automatically reload and take you to the main page (or login page if authentication is enabled). ")])],-1)),t("form",{onSubmit:T(V,["prevent"]),class:"bootstrap-form"},[t("div",N,[e[12]||(e[12]=t("h3",null,"Basic Settings",-1)),t("div",P,[e[10]||(e[10]=t("label",{class:"form-label",for:"appTitle"},"Application Title *",-1)),s(t("input",{"onUpdate:modelValue":e[0]||(e[0]=i=>o.applicationTitle=i),type:"text",id:"appTitle",class:"form-input",required:"",placeholder:"Enter application title"},null,512),[[l,o.applicationTitle]])]),t("div",$,[e[11]||(e[11]=t("label",{class:"form-label",for:"url"},"URL",-1)),s(t("input",{"onUpdate:modelValue":e[1]||(e[1]=i=>o.url=i),type:"url",id:"url",class:"form-input",placeholder:"http://localhost:3000"},null,512),[[l,o.url]])])]),t("div",I,[e[20]||(e[20]=t("h3",null,"Authentication Settings",-1)),t("div",F,[t("label",H,[s(t("input",{"onUpdate:modelValue":e[2]||(e[2]=i=>o.authentication.enabled=i),type:"checkbox",class:"form-checkbox"},null,512),[[h,o.authentication.enabled]]),e[13]||(e[13]=b(" Enable Authentication ",-1))]),e[14]||(e[14]=t("p",{class:"form-help"},"Secure access using username/password + JWTokens",-1))]),o.authentication.enabled?(r(),a("div",K,[t("div",O,[e[15]||(e[15]=t("label",{class:"form-label",for:"username"},"Username *",-1)),s(t("input",{"onUpdate:modelValue":e[3]||(e[3]=i=>o.authentication.username=i),type:"text",id:"username",class:"form-input",required:"",placeholder:"Enter username"},null,512),[[l,o.authentication.username]])]),t("div",G,[e[16]||(e[16]=t("label",{class:"form-label",for:"password"},"Password *",-1)),t("div",z,[s(t("input",{"onUpdate:modelValue":e[4]||(e[4]=i=>o.authentication.password=i),type:u.value?"text":"password",id:"password",class:"form-input",required:"",placeholder:"Enter password"},null,8,Q),[[D,o.authentication.password]]),t("button",{type:"button",onClick:e[5]||(e[5]=i=>u.value=!u.value),class:"password-toggle"},m(u.value?"Hide":"Show"),1)])]),t("div",X,[e[17]||(e[17]=t("label",{class:"form-label"},"JWT Token Key",-1)),t("div",Y,[s(t("input",{"onUpdate:modelValue":e[6]||(e[6]=i=>o.authentication.jwtSecret=i),type:"text",class:"form-input",placeholder:"32 character JWT token key",readonly:""},null,512),[[l,o.authentication.jwtSecret]]),t("button",{type:"button",onClick:w,class:"btn btn-secondary"}," Generate Key ")])]),t("div",Z,[e[19]||(e[19]=t("label",{class:"form-label",for:"jwtAge"},"JWT Token Age",-1)),s(t("select",{"onUpdate:modelValue":e[7]||(e[7]=i=>o.authentication.jwtExpiration=i),id:"jwtAge",class:"form-select"},[...e[18]||(e[18]=[B('<option value="1h" data-v-d1586726>1 Hour</option><option value="6h" data-v-d1586726>6 Hours</option><option value="12h" data-v-d1586726>12 Hours</option><option value="1d" data-v-d1586726>1 Day</option><option value="7d" data-v-d1586726>7 Days</option>',5)])],512),[[A,o.authentication.jwtExpiration]])])])):v("",!0)]),t("div",ee,[e[23]||(e[23]=t("h3",null,"Bitaxe Devices",-1)),e[24]||(e[24]=t("p",null,"Add your Bitaxe devices that you want to monitor through the configuration below.",-1)),(r(!0),a(q,null,R(o.devices,(i,f)=>(r(),a("div",{key:f,class:"device-config"},[t("div",te,[t("h4",null,"Device "+m(f+1),1),o.devices.length>1?(r(),a("button",{key:0,type:"button",onClick:c=>k(f),class:"btn btn-secondary"}," Remove ",8,oe)):v("",!0)]),t("div",ie,[e[21]||(e[21]=t("label",{class:"form-label"},"Device Name *",-1)),s(t("input",{"onUpdate:modelValue":c=>i.name=c,type:"text",class:"form-input",required:"",placeholder:"e.g., Bitaxe1"},null,8,ne),[[l,i.name]])]),t("div",se,[e[22]||(e[22]=t("label",{class:"form-label"},"Device URL *",-1)),s(t("input",{"onUpdate:modelValue":c=>i.url=c,type:"url",class:"form-input",required:"",placeholder:"e.g., http://192.168.7.220"},null,8,re),[[l,i.url]])])]))),128)),t("button",{type:"button",onClick:U,class:"btn btn-secondary"}," Add Another Device ")]),t("div",ae,[e[29]||(e[29]=t("h3",null,"Mining Core Integration (Optional)",-1)),t("div",le,[t("label",de,[s(t("input",{"onUpdate:modelValue":e[8]||(e[8]=i=>o.miningCore.enabled=i),type:"checkbox",class:"form-checkbox"},null,512),[[h,o.miningCore.enabled]]),e[25]||(e[25]=b(" Enable Mining Core Integration ",-1))]),e[26]||(e[26]=t("p",{class:"form-help"},"Connect to mining pool software for additional statistics",-1))]),o.miningCore.enabled?(r(),a("div",ue,[t("div",pe,[e[27]||(e[27]=t("label",{class:"form-label",for:"miningCoreUrl"},"Mining Core API URL *",-1)),s(t("input",{"onUpdate:modelValue":e[9]||(e[9]=i=>o.miningCore.url=i),type:"url",id:"miningCoreUrl",class:"form-input",required:"",placeholder:"e.g., http://192.168.7.149:4000"},null,512),[[l,o.miningCore.url]]),e[28]||(e[28]=t("p",{class:"form-help"},"URL to your mining core API endpoint",-1))])])):v("",!0)]),t("div",ce,[t("button",{type:"submit",disabled:p.value,class:"btn btn-primary submit-btn"},m(p.value?"Creating Configuration...":"Create Configuration"),9,me)]),d.value?(r(),a("div",ve,m(d.value),1)):v("",!0)],32)])])]))}},he=L(fe,[["__scopeId","data-v-d1586726"]]);export{he as default};
